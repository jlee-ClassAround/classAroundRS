<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>무료신청↔결제자 전화번호 매칭기 (CSV 전용 · Excel 안전 다운로드)</title>
        <link rel="stylesheet" href="style.css" />
    </head>
    <body>
        <div class="wrap">
            <div class="card">
                <h1>무료신청↔결제자 매칭기</h1>
                <p class="desc">
                    두 개의 <b>CSV</b> 파일을 올리면
                    <b>D열 전화번호(숫자만·하이폰 무시)</b> 기준으로 일치하는 사람을 찾아
                    <b>무료신청 파일의 B(이름)·C(이메일)·D(전화번호)·F(유입경로)</b>와
                    <b>결제자 파일의 G(결제금액)</b>을 출력합니다. 모든 처리는 브라우저에서만
                    수행됩니다.
                </p>

                <div class="row">
                    <div>
                        <label>① 결제자 CSV 업로드 (.csv)</label>
                        <input type="file" id="paid" accept=".csv" />
                        <div class="hint">전화번호=E, 결제금액=O</div>
                    </div>
                    <div>
                        <label>② 무료강의 신청 CSV 업로드 (.csv)</label>
                        <input type="file" id="free" accept=".csv" />
                        <div class="hint">이름=B, 이메일=C, 전화번호=D, 유입경로=F</div>
                    </div>
                </div>

                <div class="btns">
                    <button id="run" class="primary" disabled>매칭 실행</button>
                    <button id="dlCsv" disabled>CSV(UTF-8+BOM) 다운로드</button>
                    <button id="dlXls" disabled>Excel(.xls) 다운로드</button>
                    <button id="reset" class="warn">초기화</button>
                    <input
                        id="fname"
                        type="text"
                        placeholder="파일명 (예: matched)"
                        value="matched"
                        style="
                            width: 220px;
                            padding: 10px;
                            border-radius: 12px;
                            border: 1px solid var(--line);
                            background: #fff;
                            color: #000;
                        "
                    />
                    <span class="badge" id="stat">대기 중</span>
                </div>

                <div class="stat">
                    <span
                        >읽은 행수 — 결제자: <b id="paidCnt">0</b> · 무료신청:
                        <b id="freeCnt">0</b> · 매칭: <b id="matchCnt">0</b> · 구글:
                        <b id="googleCnt">0</b> · 메타: <b id="metaCnt">0</b> · 일반:
                        <b id="genCnt">0</b> · 총금액:
                        <b id="totalPrice">0</b>
                    </span>
                </div>

                <div id="tableWrap"></div>
                <div class="footer">
                    ※ CSV가 깨지면 <b>UTF-8+BOM</b> 또는 <b>Excel(.xls) 다운로드</b>를 사용하세요.
                    전화번호는 텍스트로 저장되어 010 앞자리와 길이가 보존됩니다.
                </div>
            </div>
        </div>

        <div id="toast" class="toast"></div>

        <script src="index.js"></script>
    </body>
</html>
